<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">

<link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
<link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic%7CRoboto+Slab:300,300italic,400,400italic,700,700italic%7CConsolas:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.8.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>
<meta property="og:type" content="article">
<meta property="og:title" content="非对称加密算法与数字签名">
<meta property="og:url" content="http://example.com/2019/03/31/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D/index.html">
<meta property="og:site_name" content="AmorFati">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/chenyaoyang/blog-pic/master/1/f1.jpg">
<meta property="article:published_time" content="2019-03-31T05:17:48.000Z">
<meta property="article:modified_time" content="2021-11-17T13:54:30.502Z">
<meta property="article:author" content="AmorFati">
<meta property="article:tag" content="密码学">
<meta property="article:tag" content="go">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/chenyaoyang/blog-pic/master/1/f1.jpg">


<link rel="canonical" href="http://example.com/2019/03/31/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://example.com/2019/03/31/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D/","path":"2019/03/31/非对称加密算法与数字签名/","title":"非对称加密算法与数字签名"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>非对称加密算法与数字签名 | AmorFati</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">AmorFati</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">风吹过窗前的书，又翻过一页</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#RSA%E7%AE%97%E6%B3%95"><span class="nav-number">1.</span> <span class="nav-text">RSA算法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%83%8C%E6%99%AF"><span class="nav-number">1.1.</span> <span class="nav-text">背景</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%97%E6%B3%95%E6%B5%81%E7%A8%8B"><span class="nav-number">1.2.</span> <span class="nav-text">算法流程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%BE%E4%BE%8B"><span class="nav-number">1.3.</span> <span class="nav-text">举例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RSA%E5%AE%89%E5%85%A8%E6%80%A7%E5%88%86%E6%9E%90"><span class="nav-number">1.4.</span> <span class="nav-text">RSA安全性分析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%80%9F%E5%BA%A6"><span class="nav-number">1.5.</span> <span class="nav-text">速度</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D"><span class="nav-number">1.6.</span> <span class="nav-text">数字签名</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8"><span class="nav-number">1.7.</span> <span class="nav-text">使用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A0%E8%A7%A3%E5%AF%86"><span class="nav-number">1.7.1.</span> <span class="nav-text">加解密</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D-1"><span class="nav-number">1.7.2.</span> <span class="nav-text">数字签名</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#DSA%E7%AE%97%E6%B3%95"><span class="nav-number">2.</span> <span class="nav-text">DSA算法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8-1"><span class="nav-number">2.1.</span> <span class="nav-text">使用</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#ElGamal%E7%AE%97%E6%B3%95"><span class="nav-number">3.</span> <span class="nav-text">ElGamal算法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A7%98%E9%92%A5%E7%94%9F%E6%88%90"><span class="nav-number">3.1.</span> <span class="nav-text">秘钥生成</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8A%A0%E5%AF%86"><span class="nav-number">3.2.</span> <span class="nav-text">加密</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A7%A3%E5%AF%86"><span class="nav-number">3.3.</span> <span class="nav-text">解密</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D-2"><span class="nav-number">3.4.</span> <span class="nav-text">数字签名</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#ECC%E7%AE%97%E6%B3%95"><span class="nav-number">4.</span> <span class="nav-text">ECC算法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8A%A0%E8%A7%A3%E5%AF%86%E8%BF%87%E7%A8%8B"><span class="nav-number">4.1.</span> <span class="nav-text">加解密过程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D-3"><span class="nav-number">4.2.</span> <span class="nav-text">数字签名</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%86%E9%92%A5%E5%8D%8F%E5%95%86"><span class="nav-number">4.3.</span> <span class="nav-text">密钥协商</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8-2"><span class="nav-number">4.4.</span> <span class="nav-text">使用</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%A7%98%E9%92%A5%E6%A0%BC%E5%BC%8F"><span class="nav-number">5.</span> <span class="nav-text">秘钥格式</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%86%E9%92%A5%E7%BC%96%E7%A0%81"><span class="nav-number">5.1.</span> <span class="nav-text">密钥编码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A7%98%E9%92%A5%E8%A7%A3%E7%A0%81"><span class="nav-number">5.2.</span> <span class="nav-text">秘钥解码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B6%E4%BB%96"><span class="nav-number">5.3.</span> <span class="nav-text">其他</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="AmorFati"
      src="/assets/img/icon.jpg">
  <p class="site-author-name" itemprop="name">AmorFati</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">54</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">15</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/1chenyy" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;1chenyy" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:henyang4346@foxmail.com" title="E-Mail → mailto:henyang4346@foxmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.jianshu.com/u/52c1bec4559c" title="简书 → https:&#x2F;&#x2F;www.jianshu.com&#x2F;u&#x2F;52c1bec4559c" rel="noopener" target="_blank"><i class="fa fa-globe fa-fw"></i>简书</a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/03/31/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/assets/img/icon.jpg">
      <meta itemprop="name" content="AmorFati">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AmorFati">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          非对称加密算法与数字签名
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-03-31 13:17:48" itemprop="dateCreated datePublished" datetime="2019-03-31T13:17:48+08:00">2019-03-31</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-11-17 21:54:30" itemprop="dateModified" datetime="2021-11-17T21:54:30+08:00">2021-11-17</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/" itemprop="url" rel="index"><span itemprop="name">密码学</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>8.9k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>8 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p><img src="https://raw.githubusercontent.com/chenyaoyang/blog-pic/master/1/f1.jpg"></p>
<span id="more"></span>
<h1 id="RSA算法"><a href="#RSA算法" class="headerlink" title="RSA算法"></a>RSA算法</h1><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>RSA是一种非对称加密算法，该算法在1977年由Ron Rivest、Adi Shamir和Leonard Adleman三人提出，算法一起三人姓氏开头字母命名。</p>
<p>对极大整数做因数分解的难度决定了RSA算法的可靠性。换言之，对一极大整数做因数分解愈困难，RSA算法愈可靠。假如有人找到一种快速因数分解的算法的话，那么用RSA加密的信息的可靠性就肯定会极度下降。但找到这样的算法的可能性是非常小的。今天只有短的RSA钥匙才可能被强力方式解破。到当前为止，世界上还没有任何可靠的攻击RSA算法的方式。只要其钥匙的长度足够长，用RSA加密的信息实际上是不能被解破的。</p>
<h2 id="算法流程"><a href="#算法流程" class="headerlink" title="算法流程"></a>算法流程</h2><p>RSA算法本身比较简单，基本流程如下：</p>
<ol>
<li>选择两个大素数p和q，p不等于q</li>
<li>计算N = p*q</li>
<li>令r=(p-1)(q-1)</li>
<li>寻找一个小于r的的整数e，使e与r互质</li>
<li>寻找一个整数d，使 (d*e) mod r = 1</li>
<li>(N,e)是公钥，(N,d)是私钥</li>
<li>加密时，若明文为P，则密文C = P^e mod N</li>
<li>解密时，P = C^d mod N</li>
</ol>
<h2 id="举例"><a href="#举例" class="headerlink" title="举例"></a>举例</h2><pre class="line-numbers language-none"><code class="language-none">取 p &#x3D; 7，Q &#x3D; 17
n &#x3D; p*q &#x3D; 119
r &#x3D; 6 * 16 &#x3D; 96
取e &#x3D; 5
取d &#x3D; 77
假设明文为10，密文c &#x3D; 10^e mod n &#x3D; 40
解密： 40^d mod n &#x3D; 10<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="RSA安全性分析"><a href="#RSA安全性分析" class="headerlink" title="RSA安全性分析"></a>RSA安全性分析</h2><p>回顾整个算法。我们公开的是公钥e和n，保密的是私钥d，私钥是由e和r构成的。由于e是公开的，所以攻击者需要求得r。一个途径就是根据公开的n求得p和q就得到了r。但是p和q是很大的素数，导致n也很大，所以因数分解异常困难，有数学分析证明，如果n能达到100位数，那么正确求得q和p需要数十年的时间。</p>
<h2 id="速度"><a href="#速度" class="headerlink" title="速度"></a>速度</h2><p>毫无疑问，由于涉及大量大数运算，RSA加密速度很慢。一种有效的方法是加密的一方使用一种可靠的对称加密算法加密明文，然后用RSA加密较短的秘钥，最后连同RSA加密的密文和对称加密算法加密的密文一同传输。</p>
<h2 id="数字签名"><a href="#数字签名" class="headerlink" title="数字签名"></a>数字签名</h2><p>RSA加密算法分公钥秘钥和私钥密码。用RSA进行数字签名的步骤如下</p>
<ol>
<li>发送方A对消息M进行摘要得到M1</li>
<li>A用自己的私钥对摘要进行加密，得到数字签名DS</li>
<li>A将消息M和数字签名DS一同发送给B</li>
<li>B对消息M进行摘要得到M2</li>
<li>B用A的公钥对数字签名解密得到M1</li>
<li>对比M2和M1是否相等来判断消息是否完整或被篡改</li>
</ol>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><h3 id="加解密"><a href="#加解密" class="headerlink" title="加解密"></a>加解密</h3><p>这里用go语言进行演示（其后所有实例完整代码见<a target="_blank" rel="noopener" href="https://github.com/chenyaoyang/example/tree/master/code/crypto">这里</a>），先看加解密，基本思想就是公钥加密私钥解密</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	read<span class="token operator">:=</span>rand<span class="token punctuation">.</span>Reader
	privKey<span class="token punctuation">,</span>err<span class="token operator">:=</span>rsa<span class="token punctuation">.</span><span class="token function">GenerateKey</span><span class="token punctuation">(</span>read<span class="token punctuation">,</span><span class="token number">1024</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span><span class="token punctuation">&#123;</span>
		log<span class="token punctuation">.</span><span class="token function">Fatalln</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span>
	pubKey <span class="token operator">:=</span> privKey<span class="token punctuation">.</span>PublicKey
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"N:"</span><span class="token punctuation">,</span>privKey<span class="token punctuation">.</span>N<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"公钥E:"</span><span class="token punctuation">,</span>privKey<span class="token punctuation">.</span>E<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"私钥D"</span><span class="token punctuation">,</span>privKey<span class="token punctuation">.</span>D<span class="token punctuation">)</span>

	plainText <span class="token operator">:=</span> <span class="token string">"helloworld5645你好"</span>

	ciphertext<span class="token punctuation">,</span>err<span class="token operator">:=</span>rsa<span class="token punctuation">.</span><span class="token function">EncryptPKCS1v15</span><span class="token punctuation">(</span>read<span class="token punctuation">,</span><span class="token operator">&amp;</span>pubKey<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>plainText<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span><span class="token punctuation">&#123;</span>
		log<span class="token punctuation">.</span><span class="token function">Fatalln</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">hexToString</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">)</span><span class="token punctuation">)</span>

	result<span class="token punctuation">,</span>err<span class="token operator">:=</span>rsa<span class="token punctuation">.</span><span class="token function">DecryptPKCS1v15</span><span class="token punctuation">(</span>read<span class="token punctuation">,</span>privKey<span class="token punctuation">,</span>ciphertext<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span><span class="token punctuation">&#123;</span>
		log<span class="token punctuation">.</span><span class="token function">Fatalln</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">string</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>上面代码中GenerateKey是随机生成一对秘钥，公钥是和私钥相对应的，通过查看源码可以知道公钥的结构体就是包含一个大整数N和一个整数E，私钥除了记录了公钥信息，还记录了一个大整数D就是私钥。代码中使用的加密方法是EncryptPKCS1v15，PKCS是公钥加密标准(Public-Key Cryptography Standards ),PKCS1就是一系列标准的第一个，常记做PKCS#1，也即是RSA加密标准。v15表示1.5版本，详见<a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc2313">文档</a></p>
<p>除了EncryptPKCS1v15的一套加解密方法外，还有一套OAEP方法，是另外一种填充方式，详见<a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc2437">文档</a>,用法如下：</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go">ciphertext<span class="token punctuation">,</span>err<span class="token operator">:=</span>rsa<span class="token punctuation">.</span><span class="token function">EncryptOAEP</span><span class="token punctuation">(</span>sha256<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>read<span class="token punctuation">,</span><span class="token operator">&amp;</span>pubKey<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>plainText<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">"hi"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
result<span class="token punctuation">,</span>err<span class="token operator">:=</span>rsa<span class="token punctuation">.</span><span class="token function">DecryptOAEP</span><span class="token punctuation">(</span>sha256<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>read<span class="token punctuation">,</span>privKey<span class="token punctuation">,</span>ciphertext<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">"hi"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>值得一提的是在加密时可以指定一个标签，解密时不但要秘钥正确，标签也要对应，否则无法解密，标签可以为空</p>
<h3 id="数字签名-1"><a href="#数字签名-1" class="headerlink" title="数字签名"></a>数字签名</h3><p>数字签名的签名与验证基本思路就是私钥签名，公钥验证</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	read<span class="token operator">:=</span>rand<span class="token punctuation">.</span>Reader
	privKey<span class="token punctuation">,</span>err<span class="token operator">:=</span>rsa<span class="token punctuation">.</span><span class="token function">GenerateKey</span><span class="token punctuation">(</span>read<span class="token punctuation">,</span><span class="token number">1024</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span><span class="token punctuation">&#123;</span>
		log<span class="token punctuation">.</span><span class="token function">Fatalln</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span>
	pubKey <span class="token operator">:=</span> privKey<span class="token punctuation">.</span>PublicKey

	text <span class="token operator">:=</span> <span class="token string">"helloworld5645你好"</span>


	signature1<span class="token punctuation">,</span>err<span class="token operator">:=</span>rsa<span class="token punctuation">.</span><span class="token function">SignPKCS1v15</span><span class="token punctuation">(</span>read<span class="token punctuation">,</span>privKey<span class="token punctuation">,</span>crypto<span class="token punctuation">.</span><span class="token function">Hash</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span><span class="token punctuation">&#123;</span>
		log<span class="token punctuation">.</span><span class="token function">Fatalln</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"signature1:"</span><span class="token punctuation">,</span>hex<span class="token punctuation">.</span><span class="token function">EncodeToString</span><span class="token punctuation">(</span>signature1<span class="token punctuation">)</span><span class="token punctuation">)</span>
	hashed <span class="token operator">:=</span> sha256<span class="token punctuation">.</span><span class="token function">Sum256</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>
	signature2<span class="token punctuation">,</span>err<span class="token operator">:=</span>rsa<span class="token punctuation">.</span><span class="token function">SignPKCS1v15</span><span class="token punctuation">(</span>read<span class="token punctuation">,</span>privKey<span class="token punctuation">,</span>crypto<span class="token punctuation">.</span>SHA256<span class="token punctuation">,</span>hashed<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span><span class="token punctuation">&#123;</span>
		log<span class="token punctuation">.</span><span class="token function">Fatalln</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"signature2:"</span><span class="token punctuation">,</span>hex<span class="token punctuation">.</span><span class="token function">EncodeToString</span><span class="token punctuation">(</span>signature2<span class="token punctuation">)</span><span class="token punctuation">)</span>

	err<span class="token operator">=</span>rsa<span class="token punctuation">.</span><span class="token function">VerifyPKCS1v15</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>pubKey<span class="token punctuation">,</span>crypto<span class="token punctuation">.</span><span class="token function">Hash</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">,</span>signature1<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"签名验证失败"</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"签名验证成功"</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span>
	err<span class="token operator">=</span>rsa<span class="token punctuation">.</span><span class="token function">VerifyPKCS1v15</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>pubKey<span class="token punctuation">,</span>crypto<span class="token punctuation">.</span>SHA256<span class="token punctuation">,</span>hashed<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span>signature2<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"签名验证失败"</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"签名验证成功"</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>首先还是用GenerateKey生成一对秘钥，然后使用SignPKCS1v15进行签名，由于非对称加密的效率问题，官方强烈建议对原文进行摘要后在进行签名，这是需要在第三个参数中指定所用的hash函数，如果不摘要，则用0表示。验证也是一样道理，使用VerifyPKCS1v15函数，传入要验证的内容即可。注意使用的签名和验证函数以一对PKCS1v15后缀的，和加解密一样这是用PKCS1v15标准的。还有一对使用PSS规范的方法，用法基本一样这里不再举例。</p>
<h1 id="DSA算法"><a href="#DSA算法" class="headerlink" title="DSA算法"></a>DSA算法</h1><p>先介绍一下DSA的一些基本变量</p>
<pre class="line-numbers language-none"><code class="language-none">p ：长度为L的素数，L是64的倍数
q ：(p-1)的N位素数因子
g ：h^((p-1)&#x2F;q) mod p ,h是小于p-1的数，g需要大于1
x ：小于q的数
y ：g^x mod p
H ：摘要算法<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>在以上变量中(p,q,g,y)是公开的，即公钥，x是私钥，签名过程如下（m是消息）</p>
<ol>
<li>发送方A随机选择一个小于q的随机数k，作为临时秘钥</li>
<li>r=(g^k mod p) mod q</li>
<li>s=((1/k)*(H(m)+xr)) mod q</li>
<li>r与s作为数字签名连同信息m发送给接收方B</li>
<li>B进行如下计算</li>
<li>w = (1/s) mod q</li>
<li>u1 = (H(m) * w) mod q</li>
<li>u2 = (rw) mod q</li>
<li>v = ((g^u1 * y^u2) mod p) mod q</li>
<li>最后比较v与r是否相等验证数字签名</li>
</ol>
<p>相比RSA可以用作加密，DSA只能用作签名，而且安全程度类似。</p>
<h2 id="使用-1"><a href="#使用-1" class="headerlink" title="使用"></a>使用</h2><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	read<span class="token operator">:=</span>rand<span class="token punctuation">.</span>Reader
	privKey<span class="token operator">:=</span><span class="token function">new</span><span class="token punctuation">(</span>dsa<span class="token punctuation">.</span>PrivateKey<span class="token punctuation">)</span>
	err<span class="token operator">:=</span>dsa<span class="token punctuation">.</span><span class="token function">GenerateParameters</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>privKey<span class="token punctuation">.</span>Parameters<span class="token punctuation">,</span>read<span class="token punctuation">,</span>dsa<span class="token punctuation">.</span>L1024N160<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err<span class="token operator">!=</span><span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>
		log<span class="token punctuation">.</span><span class="token function">Fatalln</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span>
	err<span class="token operator">=</span>dsa<span class="token punctuation">.</span><span class="token function">GenerateKey</span><span class="token punctuation">(</span>privKey<span class="token punctuation">,</span>read<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err<span class="token operator">!=</span><span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>
		log<span class="token punctuation">.</span><span class="token function">Fatalln</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"私钥：X ="</span><span class="token punctuation">,</span>privKey<span class="token punctuation">.</span>X<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"公钥：Y ="</span><span class="token punctuation">,</span>privKey<span class="token punctuation">.</span>PublicKey<span class="token punctuation">.</span>Y<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"公共参数："</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"p = "</span><span class="token punctuation">,</span>privKey<span class="token punctuation">.</span>PublicKey<span class="token punctuation">.</span>P<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"q = "</span><span class="token punctuation">,</span>privKey<span class="token punctuation">.</span>PublicKey<span class="token punctuation">.</span>Q<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"g = "</span><span class="token punctuation">,</span>privKey<span class="token punctuation">.</span>PublicKey<span class="token punctuation">.</span>G<span class="token punctuation">)</span>
	r<span class="token punctuation">,</span>s<span class="token punctuation">,</span>err<span class="token operator">:=</span>dsa<span class="token punctuation">.</span><span class="token function">Sign</span><span class="token punctuation">(</span>read<span class="token punctuation">,</span>privKey<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">"helloworld"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err<span class="token operator">!=</span><span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>
		log<span class="token punctuation">.</span><span class="token function">Fatalln</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"签名结果：\nr="</span><span class="token punctuation">,</span>r<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"s="</span><span class="token punctuation">,</span>s<span class="token punctuation">)</span>

	b<span class="token operator">:=</span>dsa<span class="token punctuation">.</span><span class="token function">Verify</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>privKey<span class="token punctuation">.</span>PublicKey<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">"helloworld"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>r<span class="token punctuation">,</span>s<span class="token punctuation">)</span>
	<span class="token keyword">if</span> b <span class="token punctuation">&#123;</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"签名验证成功"</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"签名验证失败"</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>首先是生成秘钥对，和rsa需要指定秘钥长度一样，这里要指定密钥对的参数长度，这里选用dsa.L1024N160，L表示p的长度，N表示q的长度。先用GenerateParameters生成参数，再用GenerateKey生成秘钥，然后用Sign签名得到r,s。最后用Verify验证。同样由于效率问题，签名时除非明文较短，否则不要直接对明文签名。注意Go语言中是按照FIPS 186-3标准实现的，详见<a target="_blank" rel="noopener" href="https://csrc.nist.gov/csrc/media/publications/fips/186/3/archive/2009-06-25/documents/fips_186-3.pdf">文档</a></p>
<h1 id="ElGamal算法"><a href="#ElGamal算法" class="headerlink" title="ElGamal算法"></a>ElGamal算法</h1><p>和RSA类似，ElGamal是一种非对称加密算法，先介绍它的加密</p>
<h2 id="秘钥生成"><a href="#秘钥生成" class="headerlink" title="秘钥生成"></a>秘钥生成</h2><ol>
<li>选取一个足够大的素数p</li>
<li>选取Zp的生成元E1</li>
<li>随机选取整数d，d小于p-2，计算E2 = E1^d mod p</li>
<li>私钥为d，公钥为(E1,E2,p)</li>
</ol>
<h2 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h2><ol>
<li>选取随机数r属于Zp-1</li>
<li>C1 = E1^r mod p</li>
<li>C2 = M*E2^r mod p (M位明文)</li>
<li>C1,C2就是密文</li>
</ol>
<h2 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h2><p>计算 (C2 * (C1^d)^-1) mod p = M</p>
<h2 id="数字签名-2"><a href="#数字签名-2" class="headerlink" title="数字签名"></a>数字签名</h2><p>公钥为(E1,E2,p),私钥为d</p>
<ol>
<li>发送方选择一个随机数r</li>
<li>S1 = E1^r mod p</li>
<li>S2 = ((M - d*S1) * r^-1) mod (p-1)</li>
<li>S1,S2就是数字签名，M是原始消息，将三种发送给接收方</li>
<li>接收方进行如下计算</li>
<li>V1 = E1 ^ M mod p</li>
<li>V2 = (E2^S1 * S1^S2) mod p</li>
<li>比较v1与v2是否相等来进行验证</li>
</ol>
<h1 id="ECC算法"><a href="#ECC算法" class="headerlink" title="ECC算法"></a>ECC算法</h1><p>ECC即EllipseCurve Cryptography，全称椭圆曲线加密。是一种基于椭圆曲线数学的公钥密码。与传统的基于大质数因子分解困难性的加密方法不同，ECC 依赖于解决椭圆曲线离散对数问题的困难性。关于椭圆曲线的知识见这里：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/Kalafinaian/p/7392505.html">ECC椭圆曲线详解</a></p>
<h2 id="加解密过程"><a href="#加解密过程" class="headerlink" title="加解密过程"></a>加解密过程</h2><ol>
<li>发送方A选择一条曲线E，同时选择曲线上一点G作为基点，基点G的阶数为n</li>
<li>A选择一个私钥d，d&lt;n。生成公钥K = dG</li>
<li>A将E、K和G传给接收方B</li>
<li>B收到信息后，将明文编码到一点M（编码方式可自由协商），并产生随机数r，r&lt;n</li>
<li>B进行如下计算</li>
<li>C1 = M+rK</li>
<li>C2 = rG</li>
<li>C1与C2就是密文</li>
<li>A收到密文后进行如下解密：M = C1 - dC2</li>
</ol>
<h2 id="数字签名-3"><a href="#数字签名-3" class="headerlink" title="数字签名"></a>数字签名</h2><p>使用ECC进行的数字签名被称为ECDSA。基本过程如下，</p>
<ol>
<li>依旧选择一条曲线E，同时选择曲线上一点G作为基点，基点G的阶数为n</li>
<li>选择一个私钥d，d&lt;n,计算公钥Q = dG</li>
<li>首先计算信息的摘要e</li>
<li>随机选择一个数k，k&lt;n</li>
<li>计算点(x1,y1) = kG</li>
<li>计算r = x1 mod n，如果r=0，回到第4步</li>
<li>计算s = k^-1(e + rd) mod n，如果s = 0，回到第4步</li>
<li>r和s就是签名值</li>
</ol>
<p>验证如下：</p>
<ol>
<li>收到消息m和签名值r，s后进行如下计算</li>
<li>先计算摘要e</li>
<li>计算w  = s^-1 mod n</li>
<li>计算u1 = ew mod n</li>
<li>计算u2 = rw mod n</li>
<li>计算点(x1,y1) = u1G+u2Q</li>
<li>判断r是否等于x1</li>
</ol>
<h2 id="密钥协商"><a href="#密钥协商" class="headerlink" title="密钥协商"></a>密钥协商</h2><p>之前我们讲过Diffie-Hellman密钥协商算法，基于的是大数分解难题，而基于ECC也有一种密钥协商算法，称为ECDH，思想是和Diffie-Hellman类似的，基本流程如下：</p>
<ol>
<li>A,B双方协商一条椭圆曲线及基点G，这些数据是可以明文传播的</li>
<li>A计算自己的公钥和私钥，即da与Da，其中Da=da*G</li>
<li>B计算自己的公钥和私钥，即db与Db，其中Db=db*G</li>
<li>双方交换公钥</li>
<li>A计算密钥Sa=da*Db</li>
<li>B计算密钥Sb=db*Da</li>
<li>可以证明Sa=Sb：Sa=da*Db=da*db*G，Sb=db*Da=db*da*G</li>
</ol>
<h2 id="使用-2"><a href="#使用-2" class="headerlink" title="使用"></a>使用</h2><p>下面例子是ecdsa</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	read<span class="token operator">:=</span>rand<span class="token punctuation">.</span>Reader
	priv<span class="token punctuation">,</span>err<span class="token operator">:=</span>ecdsa<span class="token punctuation">.</span><span class="token function">GenerateKey</span><span class="token punctuation">(</span>elliptic<span class="token punctuation">.</span><span class="token function">P256</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>read<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>
		log<span class="token punctuation">.</span><span class="token function">Fatalln</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span>
	r<span class="token punctuation">,</span>s<span class="token punctuation">,</span>err<span class="token operator">:=</span>ecdsa<span class="token punctuation">.</span><span class="token function">Sign</span><span class="token punctuation">(</span>read<span class="token punctuation">,</span>priv<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>
		log<span class="token punctuation">.</span><span class="token function">Fatalln</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"签名结果"</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"r = "</span><span class="token punctuation">,</span>r<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"s = "</span><span class="token punctuation">,</span>s<span class="token punctuation">)</span>
	b <span class="token operator">:=</span> ecdsa<span class="token punctuation">.</span><span class="token function">Verify</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>priv<span class="token punctuation">.</span>PublicKey<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>r<span class="token punctuation">,</span>s<span class="token punctuation">)</span>
	<span class="token keyword">if</span> b <span class="token punctuation">&#123;</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"签名验证成功"</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"签名验证失败"</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>虽然标准包中没有提供ecc的实现，但是有elliptic包，提供了椭圆曲线的一些基本运算，再参考ecdsa可以自行设计加解密算法。对于ecdh在以太坊的ecies有实现</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>prv <span class="token operator">*</span>PrivateKey<span class="token punctuation">)</span> <span class="token function">GenerateShared</span><span class="token punctuation">(</span>pub <span class="token operator">*</span>PublicKey<span class="token punctuation">,</span> skLen<span class="token punctuation">,</span> macLen <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>sk <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	<span class="token keyword">if</span> prv<span class="token punctuation">.</span>PublicKey<span class="token punctuation">.</span>Curve <span class="token operator">!=</span> pub<span class="token punctuation">.</span>Curve <span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> ErrInvalidCurve
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">if</span> skLen<span class="token operator">+</span>macLen <span class="token operator">></span> <span class="token function">MaxSharedKeyLength</span><span class="token punctuation">(</span>pub<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> ErrSharedKeyTooBig
	<span class="token punctuation">&#125;</span>

	x<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> pub<span class="token punctuation">.</span>Curve<span class="token punctuation">.</span><span class="token function">ScalarMult</span><span class="token punctuation">(</span>pub<span class="token punctuation">.</span>X<span class="token punctuation">,</span> pub<span class="token punctuation">.</span>Y<span class="token punctuation">,</span> prv<span class="token punctuation">.</span>D<span class="token punctuation">.</span><span class="token function">Bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> x <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> ErrSharedKeyIsPointAtInfinity
	<span class="token punctuation">&#125;</span>

	sk <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> skLen<span class="token operator">+</span>macLen<span class="token punctuation">)</span>
	skBytes <span class="token operator">:=</span> x<span class="token punctuation">.</span><span class="token function">Bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token function">copy</span><span class="token punctuation">(</span>sk<span class="token punctuation">[</span><span class="token function">len</span><span class="token punctuation">(</span>sk<span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">len</span><span class="token punctuation">(</span>skBytes<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> skBytes<span class="token punctuation">)</span>
	<span class="token keyword">return</span> sk<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h1 id="秘钥格式"><a href="#秘钥格式" class="headerlink" title="秘钥格式"></a>秘钥格式</h1><p>一些规范对RSA秘钥的格式也有一些要求，具体格式语法就不介绍了，go语言提供方便的转换接口</p>
<h2 id="密钥编码"><a href="#密钥编码" class="headerlink" title="密钥编码"></a>密钥编码</h2><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	read<span class="token operator">:=</span>rand<span class="token punctuation">.</span>Reader
	privKey<span class="token punctuation">,</span>err<span class="token operator">:=</span>rsa<span class="token punctuation">.</span><span class="token function">GenerateKey</span><span class="token punctuation">(</span>read<span class="token punctuation">,</span><span class="token number">1024</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span><span class="token punctuation">&#123;</span>
		log<span class="token punctuation">.</span><span class="token function">Fatalln</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span>
	pubKey <span class="token operator">:=</span> privKey<span class="token punctuation">.</span>PublicKey

	encodePrivKey <span class="token operator">:=</span> x509<span class="token punctuation">.</span><span class="token function">MarshalPKCS1PrivateKey</span><span class="token punctuation">(</span>privKey<span class="token punctuation">)</span>
	block1<span class="token operator">:=</span>pem<span class="token punctuation">.</span>Block<span class="token punctuation">&#123;</span>
		Type<span class="token punctuation">:</span>  <span class="token string">"RSA PRIVATE KEY"</span><span class="token punctuation">,</span>
		Bytes<span class="token punctuation">:</span> encodePrivKey<span class="token punctuation">,</span>
	<span class="token punctuation">&#125;</span>
	pem<span class="token punctuation">.</span><span class="token function">Encode</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>Stdout<span class="token punctuation">,</span><span class="token operator">&amp;</span>block1<span class="token punctuation">)</span>

	encodePubvKey <span class="token operator">:=</span> x509<span class="token punctuation">.</span><span class="token function">MarshalPKCS1PublicKey</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>pubKey<span class="token punctuation">)</span>
	block2<span class="token operator">:=</span>pem<span class="token punctuation">.</span>Block<span class="token punctuation">&#123;</span>
		Type<span class="token punctuation">:</span>  <span class="token string">"RSA PUBLIC KEY"</span><span class="token punctuation">,</span>
		Bytes<span class="token punctuation">:</span> encodePubvKey<span class="token punctuation">,</span>
	<span class="token punctuation">&#125;</span>
	pem<span class="token punctuation">.</span><span class="token function">Encode</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>Stdout<span class="token punctuation">,</span><span class="token operator">&amp;</span>block2<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>首先利用x509包中的MarshalPKCS1PrivateKey方法对秘钥进行序列化，然后利用pem包进行编码，编码前首先要用Block对秘钥进行包装，主要是指定Type，最后生成数据如下</p>
<pre class="line-numbers language-none"><code class="language-none">-----BEGIN RSA PRIVATE KEY-----
MIICXQIBAAKBgQDQ6x6qUOn6lct8npBizj9thh9RrPi35wez7EHmRLH9QYhJqtJV
p&#x2F;9B5ITgwXR1VBM4shJ3RvNUj+diT8ox0FUuw4+3EZqW5tSgoQGzV3Go+PX+4p21
u874GOqYtFUDmhQjMuh4NtsBfnClGsf9pUmInjxsVKKfdUbYZxLKzGK2DwIDAQAB
AoGAMeyNtmuBjlUvfEcz&#x2F;7iDpbuQTmdEREYcLB3AHbO6yOdZFymP+9IaiHeAXWk9
WDBQK5M6IHC&#x2F;Ay0kQPUKP18mi4hXKm4hRql3B3rJoV6qiP3&#x2F;c5hYakhSSPouPmoC
30a1ERWnKlH9YSMDOhYUY1c02onYsY9AxM18N27AOYLSMWECQQD75aGjjYY+lDKb
UXsqSLgL4hbPTswKjYJU6ps6hkJKEklMI5rQk&#x2F;J5yLuji7USJdmGJziZin41vGx&#x2F;
NSQlsUuRAkEA1FJGYeC4idHhYZ5NIKgSefWn9+lgIDzxjIAivcViTFLd9bz4UcSQ
U+FzEHEkA78C0y3g30NqAGkspVuxfO7XnwJBALO26DSM0xswlk5zuqC3Uv+&#x2F;ZTCw
ciiRP0wgOXFuujqogzzcJibrdtJmYWDUWvJAqMnqj5oT0em6rdmv60MtE9ECQDvG
qiAWV34dw9lq6wX9q64Adni6kKCi59KJpL5O2vzn+6uat0K2F3g2KeIAKIaReWch
LIVPAoH5GmO3rAGjcLsCQQDMDtQxU3DTcrLyKgx+N3n4jqkDOsK&#x2F;iiotvdHFrQvr
dPJPsUtSsFa0ejvIO6Mf0d9h4fi4vNIIIIS1QjpAkOE4
-----END RSA PRIVATE KEY-----<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="秘钥解码"><a href="#秘钥解码" class="headerlink" title="秘钥解码"></a>秘钥解码</h2><p>给出一段上文表示秘钥可以用下面方法解码</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	read<span class="token operator">:=</span>rand<span class="token punctuation">.</span>Reader
	privKey<span class="token punctuation">,</span>err<span class="token operator">:=</span>rsa<span class="token punctuation">.</span><span class="token function">GenerateKey</span><span class="token punctuation">(</span>read<span class="token punctuation">,</span><span class="token number">1024</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span><span class="token punctuation">&#123;</span>
		log<span class="token punctuation">.</span><span class="token function">Fatalln</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span>

	encodePrivKey <span class="token operator">:=</span> x509<span class="token punctuation">.</span><span class="token function">MarshalPKCS1PrivateKey</span><span class="token punctuation">(</span>privKey<span class="token punctuation">)</span>
	block1<span class="token operator">:=</span>pem<span class="token punctuation">.</span>Block<span class="token punctuation">&#123;</span>
		Type<span class="token punctuation">:</span>  <span class="token string">"RSA PRIVATE KEY"</span><span class="token punctuation">,</span>
		Bytes<span class="token punctuation">:</span> encodePrivKey<span class="token punctuation">,</span>
	<span class="token punctuation">&#125;</span>
	file<span class="token punctuation">,</span> err <span class="token operator">:=</span> os<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token string">"priv.pem"</span><span class="token punctuation">)</span>
	pem<span class="token punctuation">.</span><span class="token function">Encode</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span><span class="token operator">&amp;</span>block1<span class="token punctuation">)</span>

	key<span class="token punctuation">,</span>err<span class="token operator">:=</span>ioutil<span class="token punctuation">.</span><span class="token function">ReadFile</span><span class="token punctuation">(</span><span class="token string">"priv.pem"</span><span class="token punctuation">)</span>
	block<span class="token punctuation">,</span><span class="token boolean">_</span><span class="token operator">:=</span>pem<span class="token punctuation">.</span><span class="token function">Decode</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
	<span class="token keyword">if</span> block <span class="token operator">==</span><span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>
		log<span class="token punctuation">.</span><span class="token function">Fatalln</span><span class="token punctuation">(</span><span class="token string">"nil"</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span>
	privkey2<span class="token punctuation">,</span>err<span class="token operator">:=</span>x509<span class="token punctuation">.</span><span class="token function">ParsePKCS1PrivateKey</span><span class="token punctuation">(</span>block<span class="token punctuation">.</span>Bytes<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>privKey<span class="token punctuation">.</span>D<span class="token punctuation">.</span><span class="token function">Cmp</span><span class="token punctuation">(</span>privkey2<span class="token punctuation">.</span>D<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>privKey<span class="token punctuation">.</span>N<span class="token punctuation">.</span><span class="token function">Cmp</span><span class="token punctuation">(</span>privkey2<span class="token punctuation">.</span>N<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>基本就是编码的逆过程，先decode再Parse。</p>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><p>除了可以编解码PKCS1规范的秘钥，还提供了MarshalPKCS8PrivateKey、MarshalECPrivateKey与 MarshalPKIXPublicKey等，用于支持不同的密钥或规范</p>
<blockquote>
<p>题图来自unsplash：<a target="_blank" rel="noopener" href="https://unsplash.com/photos/KidY3t8O4PE">https://unsplash.com/photos/KidY3t8O4PE</a></p>
</blockquote>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/" rel="tag"><i class="fa fa-tag"></i> 密码学</a>
              <a href="/tags/go/" rel="tag"><i class="fa fa-tag"></i> go</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2019/03/31/grpc%E5%AD%A6%E4%B9%A0/" rel="prev" title="grpc学习">
                  <i class="fa fa-chevron-left"></i> grpc学习
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2019/04/01/Kademlia%EF%BC%9A%E4%B8%80%E4%B8%AA%E5%9F%BA%E4%BA%8E%E5%BC%82%E6%88%96%E5%BA%A6%E9%87%8F%E7%9A%84P2P%E4%BF%A1%E6%81%AF%E7%B3%BB%E7%BB%9F/" rel="next" title="Kademlia：一个基于异或度量的P2P信息系统">
                  Kademlia：一个基于异或度量的P2P信息系统 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2018 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">AmorFati</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">633k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">9:36</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  





</body>
</html>
